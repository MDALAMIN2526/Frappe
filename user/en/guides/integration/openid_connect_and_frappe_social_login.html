<!DOCTYPE html>
<!-- Built on Frappe. https://frappe.io/ -->
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>OpenID Connect and Frappe social login</title>
	<meta name="generator" content="frappe">
    <link type="text/css" rel="stylesheet" href="https://frappe.github.io/frappe/assets/css/bootstrap.css">
    <link type="text/css" rel="stylesheet" href="https://frappe.github.io/frappe/assets/css/hljs.css">
    <link type="text/css" rel="stylesheet" href="https://frappe.github.io/frappe/assets/css/font-awesome.css">
    <link type="text/css" rel="stylesheet" href="https://frappe.github.io/frappe/assets/css/octicons/octicons.css">
    <link type="text/css" rel="stylesheet" href="https://frappe.github.io/frappe/assets/css/docs.css">

    
	<link rel="shortcut icon"
		href="https://frappe.github.io/frappe/assets/img/favicon.png"
		type="image/x-icon">
	<link rel="icon"
		href="https://frappe.github.io/frappe/assets/img/favicon.png"
		type="image/x-icon">
    

		</head>
<body data-path="user/en/guides/integration/openid_connect_and_frappe_social_login">
	<div class="main-section">
		<div>
					<nav class="navbar navbar-default navbar-main" role="navigation">
		<div class="container">
			<div class="navbar-header">
				<a class="navbar-brand ellipsis"
					 href="https://frappe.github.io/frappe//">
					<span><img class="brand-logo" src="https://frappe.github.io/frappe/assets/img/frappe-bird-white.png"> Frapp√© Framework</img></span>
				</a>
				<div class="dropdown">
					<button class="btn btn-default navbar-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
						<i class="octicon octicon-three-bars"></i>
					</button>
					<ul class="dropdown-menu dropdown-menu-right">
<li data-label='<i class="octicon octicon-search"></i>' >
	<a href="/#"
		
		>
	<i class="octicon octicon-search"></i></a></li><li data-label='Tutorials' >
	<a href="https://frappe.github.io/frappe/user"
		
		>
	Tutorials</a></li><li data-label='API' >
	<a href="https://frappe.github.io/frappe/current"
		
		>
	API</a></li><li data-label='Forum' >
	<a href="https://discuss.erpnext.com"
		
		>
	Forum</a></li>

<li class="divider"></li>

<!-- post login tools -->

</ul>
				</div>
			</div>
			<div class="hidden-xs">
				
				<ul class="nav navbar-nav navbar-left">
</ul>
<ul class="nav navbar-nav navbar-right"><li data-label='<i class="octicon octicon-search"></i>' >
	<a href="/#"
		
		>
	<i class="octicon octicon-search"></i></a></li><li data-label='Tutorials' >
	<a href="https://frappe.github.io/frappe/user"
		
		>
	Tutorials</a></li><li data-label='API' >
	<a href="https://frappe.github.io/frappe/current"
		
		>
	API</a></li><li data-label='Forum' >
	<a href="https://discuss.erpnext.com"
		
		>
	Forum</a></li>
	
	
	<!-- post login tools -->

</ul>
				
			</div>
		</div>
	</nav><div class="hero-and-content">
                <div data-html-block="hero"></div>
                <div class="container" data-html-block="content">
                
<div class="page-container" id="page-user/en/guides/integration/openid_connect_and_frappe_social_login" data-path="{{ pathname }}"
	>
	<div class="row ">
		
		<div class=" page-content col-sm-12 ">
			<div class="page-content-wrapper">
				<div class="row page-head">
					<div class='col-sm-12 hidden-xs'>
						
						<div class="page-breadcrumbs">
							
							
<ul class="breadcrumb">
	<li>
		<span class="fa fa-angle-left"></span>
		<a href="https://frappe.github.io/frappe//user/en/guides/integration">
		Integrations</a>
	</li>
	
</ul>

							
						</div>
						
					</div>
					<div class="col-sm-8 col-xs-6">
						
					</div>
					<div class="col-sm-4 col-xs-6">
						

						
					</div>
				</div>
			</div>
			<div class="page_content">
<h1>OpenID Connect and Frappe social login</h1>

<h2>OpenID Connect</h2>

<p>Frappe also uses Open ID connect essential standard for authenticating users. To get <code>id_token</code> with <code>access_token</code>, pass <code>openid</code> as the value for the scope parameter during authorization request.</p>

<p>If the scope is <code>openid</code> the JSON response with <code>access_token</code> will also include a JSON Web Token (<code>id_token</code>) signed with <code>HS256</code> and <code>Client Secret</code>. The decoded <code>id_token</code> includes the <code>at_hash</code>.</p>

<p>Example Bearer Token with scope <code>openid</code></p>

<p><code>
{
  "token_type": "Bearer",
  "id_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6Imp3dCJ9.eyJpc3MiOiJodHRwczovL21udGVjaG5pcXVlLmNvbSIsImF0X2hhc2giOiJOQlFXbExJUy1lQ1BXd1d4Y0EwaVpnIiwiYXVkIjoiYjg3NzJhZWQ1YyIsImV4cCI6MTQ3Nzk1NTYzMywic3ViIjoiNWFjNDE2NThkZjFiZTE1MjI4M2QxYTk0YjhmYzcwNDIifQ.1GRvhk5wNoR4GWoeQfleEDgtLS5nvj9nsO4xd8QE-Uk",
  "access_token": "ZJD04ldyyvjuAngjgBrgHwxcOig4vW",
  "scope": "openid",
  "expires_in": 3600,
  "refresh_token": "2pBTDTGhjzs2EWRkcNV1N67yw0nizS"
}
</code></p>

<h2>Frappe social login setup</h2>

<p>In this example there are 2 servers,</p>

<h3>Primary Server</h3>

<p>This is the main server hosting all the users. e.g. <code>https://frappe.io</code>. To setup this as the main server, go to <em>Setup</em> &gt; <em>Integrations</em> &gt; <em>Social Login Keys</em> and enter <code>https://frappe.io</code> in the field  <code>Frappe Server URL</code>. This URL repeats in all other Frappe servers who connect to this server to authenticate. Effectively, this is the main Identity Provider (IDP). </p>

<p>Under this server add as many <code>OAuth Client</code>(s) as required. Because we are setting up one app server, add only one <code>OAuth Client</code></p>

<h3>Frappe App Server</h3>

<p>This is the client connecting to the IDP. Go to <em>Setup</em> &gt; <em>Integrations</em> &gt; <em>Social Login Keys</em> on this server and add appropriate values to <code>Frappe Client ID</code> and <code>Frappe Client Secret</code> (refer to client added in primary server). As mentioned before keep the <code>Frappe Server URL</code> as <code>https://frappe.io</code></p>

<p>Now you will see Frappe icon on the login page. Click on this icon to login with account created in primary server (IDP) <code>https://frappe.io</code></p>

<p><strong>Note</strong>: If <code>Skip Authorization</code> is checked while registering a client, page to allow or deny the granting access to resource is not shown. This can be used if the apps are internal to one organization and seamless user experience is needed.</p>

<h2>Steps</h2>

<h3>Part 1 : on Frappe Identity Provider (IDP)</h3>

<p>Login to IDP
<img class="screenshot" src="https://frappe.github.io/frappe/assets/img/00-login-to-idp.png"></p>

<p>Add OAuth Client on IDP
<img class="screenshot" src="https://frappe.github.io/frappe/assets/img/01-add-oauth-client-on-idp.png"></p>

<p>Set Server URL on IDP
<img class="screenshot" src="https://frappe.github.io/frappe/assets/img/02-set-server-url-on-idp.png"></p>

<h3>Part 2 : on Frappe App Server</h3>

<p>Set <code>Frappe Client ID</code>  and <code>Frappe Client Secret</code> on App server (refer the client set on IDP)
<img class="screenshot" src="https://frappe.github.io/frappe/assets/img/03-set-clientid-client-secret-server-on-app-server.png"></p>

<p><strong>Note</strong>: Frappe Server URL is the main server where identities from your organization are stored.</p>

<p>Login Screen on App Server (login with frappe)
<img class="screenshot" src="https://frappe.github.io/frappe/assets/img/04-login-screen-on-app-server.png"></p>

<h3>Part 3 : Redirected on IDP</h3>

<p>login with user on IDP
<img class="screenshot" src="https://frappe.github.io/frappe/assets/img/05-login-with-user-on-idp.png"></p>

<p>Confirm Access on IDP
<img class="screenshot" src="https://frappe.github.io/frappe/assets/img/06-confirm-grant-access-on-idp.png"></p>

<h3>Part 4 : Back on App Server</h3>

<p>Logged in on app server with ID from IDP
<img class="screenshot" src="https://frappe.github.io/frappe/assets/img/07-logged-in-as-website-user-with-id-from-idp.png"></p>

</div>
		</div>
	</div>
</div>

				
<div class="page-container">
	<div class="page-content">
	<div class="edit-container text-center">
		<i class="fa fa-smile"></i>
		<a class="text-muted edit" href="https://github.com/frappe/frappe/blob/develop/frappe/docs/user/en/guides/integration/openid_connect_and_frappe_social_login.md">
			Improve this page
		</a>
	</div>
	</div>
</div>
                </div>
            </div>
			<footer class="docs-footer">
				<div class="container"><div class="built-with-frappe text-center">
                    <img class="frappe-bird" src="https://frappe.github.io/frappe/assets/img/frappe-bird-grey.svg">
                    <h3>By Frappe Technologies</h3>
                </div>
                <div class="text-center">
                    <ul class="list-unstyled">
                        <li>
                            <a href="https://github.com/frappe/frappe">
                            Source</a>
                        </li>
                        <li>
                            <a href="https://github.com/frappe/frappe/issues">
                            Issues</a>
                        </li>
                        <li>
                            <a href="https://frappe.github.io/frappe/license.html">
                            License</a>
                        </li>
                        <li>
                            <a href="https://discuss.erpnext.com">
                            Forum</a>
                        </li>
                        <li>
                            <a href="https://community.erpnext.com/apps">
                            Frappe Apps</a>
                        </li>
                    </ul>
                </div>

            </div>
			</footer>
		</div>
	</div>

	<script type="text/javascript" src="https://frappe.github.io/frappe/assets/js/jquery.min.js"></script>
	<script type="text/javascript" src="https://frappe.github.io/frappe/assets/js/bootstrap.min.js"></script>
	<script type="text/javascript" src="https://frappe.github.io/frappe/assets/js/highlight.pack.js"></script>
	<script type="text/javascript" src="https://frappe.github.io/frappe/assets/js/docs.js"></script>

	<!-- js should be loaded in body! -->
	<script>
        window.docs_base_url = "https://frappe.github.io/frappe";
    </script>

	
	<script>
	  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

	  ga('create', 'UA-8911157-23', 'auto');
	  ga('send', 'pageview');

	</script>
	
	<!-- csrf_token --></body>
</html>